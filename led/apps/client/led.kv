#:kivy 1.8.0

<AutoTextSizeButton>
    font_size: root.height / 3

<LedScreenManager>
    MainScreen:
    ProjectScreen:
    FileChooserScreen:
    ConnectDisplayScreen:

<MainScreen>
    name: 'main_screen'
    BoxLayout:
        id: reactive_layout
        padding: 20
        spacing: 10
        orientation: 'vertical'
        Image:
            source: '.\keesware_led_banner.gif'
            allow_stretch: True
            anim_delay: 1/10.0
            keep_ratio: False
        AutoTextSizeButton:
            text: "Create Animation"
            on_release: app.root.current = 'project_screen'
        AutoTextSizeButton:
            text: "Open Animation"
            on_release: app.root.current = 'file_chooser_screen'
        AutoTextSizeButton:
            text: "Connect to Display"
            on_release: app.root.current = 'connect_display_screen'
        AutoTextSizeButton:
            text: "Live"

<ProjectScreen>
    name: 'project_screen'
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.1
            orientation: 'horizontal'
            AutoTextSizeButton:
                text: "Main Menu"
                on_release: app.root.current = 'main_screen'

            Spinner:
                id: select_effect_spinner
                text: 'Select Effect'
                values: root._screen_text_to_ids.keys()
                on_text: root.effect_changed()
                size_hint_y: None
                height: '48dp'

        EffectScreenManager:
            id: effect_screen_manager
        DisplayWidget:
            id: display_widget


<FileChooserScreen>
    name: 'file_chooser_screen'
    chosen_image_path: root.chosen_image_path
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.1
            orientation: 'horizontal'
            AutoTextSizeButton:
                size_hint: 0.2, 1
                text: "back to Main Menu"
                on_release: app.root.current = 'main_screen'
            Label:
                text: root.chosen_image_path
        BoxLayout:
            orientation: 'horizontal'
            FileChooserListView:
                id: file_chooser_icon_view
                show_hidden: False
                on_selection: root.update_image_path()
                on_path: root.update_image_path()
            Image:
                id: preview_image
                source: root.chosen_image_path

<ConnectDisplayScreen>
    name: 'connect_display_screen'
    BoxLayout:
        orientation: 'vertical'
        AutoTextSizeButton:
            size_hint: 1, 0.1
            text: "back to Main Menu"
            on_release: app.root.current = 'main_screen'

        BoxLayout:
            orientation: 'horizontal'

            BoxLayout:
                orientation: 'vertical'
                Label:
                    text: "Display IP:"
                Label:
                    text: "Port"
                Label:
                    text: "Width"
                Label:
                    text: "Height"
                AutoTextSizeButton:
                    id: connect_button
                    text: "Connect"
                    on_release: root.connect()
                    disabled: root._connection_provider.is_connected()

            BoxLayout:
                orientation: 'vertical'
                TextInput:
                    id: ip_address_text_input
                    text: "127.0.0.1"
                    multiline: False
                TextInput:
                    id: port_text_input
                    text: "6666"
                    multiline: False
                TextInput:
                    id: width_text_input
                    text: "8"
                    multiline: False
                TextInput:
                    id: height_text_input
                    text: "8"
                    multiline: False
                AutoTextSizeButton:
                    id: disconnect_button
                    text: "Disconnect"
                    on_release: root.disconnect()
                    disabled: not root._connection_provider.is_connected()


<ColorButton>
    font_size: root.height / 3
    background_normal: ''
    background_down: ''


<EffectScreenManager>
    RainbowEffectScreen:
    TextEffectScreen:


<TextEffectScreen>
    name: 'text_effect_screen'
    TextInput:
        id: text_input
        text: "KeesWare"
        on_text: root.draw_text()
        multiline: False

<RainbowEffectScreen>
    name: 'rainbow_effect_screen'
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.2
            orientation: 'horizontal'
            ColorButton:
                id: left_color_button
                text: "Left"
                background_color: (1, 0, 0, 1)
                group: 'color'
                on_press: root._selected_button = self

            ColorButton:
                id: right_color_button
                text: "Right"
                background_color: (0, 1, 0, 1)
                group: 'color'
                on_press: root._selected_button = self

        ColorPicker:
            id: color_picker
            color: (0, 0, 1, 1)
            on_color: root.on_color()

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, 0.2
            Slider:
                id: speed_slider
                min: 0
                max: 30
                value: 30
                on_value: root.animation_speed_changed()

            Label:
                id: fps_label
                size_hint: 0.2, 1